/**
 * @name: trackpush
 * @author: aimtell
 * @description: implements push approval & tracker
 * @version: 3.9438
 */

"use strict";var _aimtellPushToken,_aimtellRanScript,_aimtellSubscriberID,_aimtellRefreshResult,_aimtellAPI="https://api.aimtell.com/prod",_aimtellSWInitiated=!1,_aimtellNewSubscriberID=!1,_aimtellVersion=3.9437,_aimtellDebugQueue=[],_aimtellDebugQueueActive=0,_aimtellPrompted=!1,_aimtellCacheBuster=12919,_aimtellUserDefinedWorker=null;"undefined"==typeof _at.track&&(_aimtellVersion=3.933);var trackData,_aimtellTrackData,_aimtellPageLoadAttributes=JSON.parse(JSON.stringify(_at.attributes));if("undefined"==typeof _at.webpushid&&(_at.webpushid="web.aimtell.com"),_at.webpushid=_at.webpushid.replace("apple.com","aimtell.com"),"undefined"==typeof _at.worker?_at.worker=window.location.origin+"/aimtell-worker.js?v="+_aimtellVersion+"&cb="+_aimtellCacheBuster:(_aimtellUserDefinedWorker=_at.worker,_at.worker=_at.worker+"?v="+_aimtellVersion+"&cb="+_aimtellCacheBuster),"/wp-content/plugins/aimtell-web-push-notifications/assets/json/aimtell-manifest.json"==_at.manifest&&(_at.manifest="https://s3.amazonaws.com/cdn.aimtell.com/manifest/"+_at.idSite+".json"),!1!==_at.showCredit&&console.log("Push notifications powered by Aimtell. Learn more at https://aimtell.com/developers"),1==_aimtellGetUrlVars().aimtelldebug||!0===_at.debug){var _aimtellDebug=1,aimtellDebugBox=document.createElement("DIV");aimtellDebugBox.setAttribute("id","aimtellDebugBox"),aimtellDebugBox.innerHTML="<style> #aimtellDebugBoxTitle{ background:#E9E9E9; font-size:16px; padding-top:10px; display:block; margin-left:-25px; margin-right:-25px; padding-bottom:10px;} #aimtellDebugBox{ position:fixed; overflow-y:scroll; padding-left:25px; padding-right:25px; bottom:0px; height:200px; width:100%; background:#FFF; z-index:99999999; border-top:1px solid #E9E9E9 } .aimtellDebugBoxItem{ padding:5px; font-size:14px; border-bottom:1px solid #E9E9E9;}</style> <center><b id='aimtellDebugBoxTitle'>Aimtell Debugger v1.5</b></center><div id='aimtellDebugBoxList'> </div>",aimtellDebugBox.style.display="none",document.body.appendChild(aimtellDebugBox),_aimtellDebugQueueProcess()}function _aimtellDeferred(){this._done=[],this._fail=[]}_aimtellDeferred.prototype={execute:function(e,t){var n=e.length;for(t=Array.prototype.slice.call(t);n--;)e[n].apply(null,t)},resolve:function(){this.execute(this._done,arguments)},reject:function(){this.execute(this._fail,arguments)},done:function(e){this._done.push(e)},fail:function(e){this._fail.push(e)}};function _aimtellGetUrlVars(){var e={},i=window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(i,t,n){e[t]=n});return e}function _aimtellGetDeviceType(){var e=1,i="desktop";return function(i){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(i)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(i.substr(0,4)))&&(e=2)}(navigator.userAgent||navigator.vendor||window.opera),2==e&&(i="mobile"),i}function _aimtellGetPageDetails(){var e=document.title,i=window.location.href;return{pageTitle:e,pageURL:i}}function _aimtellLoadBeacon(){var e=document.createElement("iframe");e.setAttribute("src","https://beacon.aimtell.com/?id_site="+_at.idSite+"&subscriber_uid="+_at.subscriber),e.style.width="1px",e.style.height="1px",e.style.display="none",document.body.appendChild(e)}function _aimtellGetReferrer(){var e=null,i=null;return 0!==document.referrer.indexOf(location.protocol+"//"+location.host)&&(e=document.referrer?document.referrer:null,i=document.referrer?document.referrer.split("/")[2]:null),{refName:i,refUrl:e}}function _aimtellGetLanguage(){var e=navigator.language||navigator.userLanguage;return e}function _aimtellGetResolution(){var e="";if(screen.width){var i=screen.width?screen.width:"",t=screen.height?screen.height:"";e+=""+i+" x "+t}return e}function _aimtellGetBrowserInfo(){var e,i,t,n=navigator.appVersion,o=navigator.userAgent,s=navigator.appName,r=""+parseFloat(navigator.appVersion),a=parseInt(navigator.appVersion,10);return-1!=(i=o.indexOf("Opera"))&&(s="Opera",r=o.substring(i+6),-1!=(i=o.indexOf("Version"))&&(r=o.substring(i+8))),-1==(i=o.indexOf("OPR"))?-1==(i=o.indexOf("MSIE"))?-1==(i=o.indexOf("Edge"))?-1==(i=o.indexOf("Chrome"))?-1==(i=o.indexOf("Safari"))?-1==(i=o.indexOf("Firefox"))?-1==o.indexOf("Trident/")?(e=o.lastIndexOf(" ")+1)<(i=o.lastIndexOf("/"))&&(s=o.substring(e,i),r=o.substring(i+1),s.toLowerCase()==s.toUpperCase()&&(s=navigator.appName)):(s="Microsoft Internet Explorer",r=o.substring(o.indexOf("rv:")+3)):(s="Firefox",r=o.substring(i+8)):(s="Safari",r=o.substring(i+7),-1!=(i=o.indexOf("Version"))&&(r=o.substring(i+8))):(s="Chrome",r=o.substring(i+7)):(s="Edge",r=o.substring(i+5)):(s="Microsoft Internet Explorer",r=o.substring(i+5)):(s="Opera",r=o.substring(i+4)),-1!=(t=r.indexOf(";"))&&(r=r.substring(0,t)),-1!=(t=r.indexOf(" "))&&(r=r.substring(0,t)),-1!=(t=r.indexOf(")"))&&(r=r.substring(0,t)),a=parseInt(""+r,10),isNaN(a)&&(r=""+parseFloat(navigator.appVersion),a=parseInt(navigator.appVersion,10)),{browser:s,version:r,majorVersion:a}}function _aimtellGetSystemInfo(){var e=navigator.userAgent,i=navigator.appVersion,t="-",n=[{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 3.11",r:/Win16/},{s:"Android",r:/Android/},{s:"Open BSD",r:/OpenBSD/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"Search Bot",r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}];for(var o in n){var s=n[o];if(s.r.test(e)){t=s.s;break}}var r="-";return /Windows/.test(t)&&(r=/Windows (.*)/.exec(t)[1],t="Windows"),"Mac OS X"===t?r=/Mac OS X (10[\.\_\d]+)/.exec(e)[1]:"Android"===t?r=/Android ([\.\_\d]+)/.exec(e)[1]:"iOS"===t?(r=/OS (\d+)_(\d+)_?(\d+)?/.exec(i),r=r[1]+"."+r[2]+"."+(0|r[3])):void 0,{os:t,osVersion:r}}function _aimtellDebugger(e,i){3===i?console.log("[aimtell] "+e):4===i?console.warn("[aimtell] "+e):5===i?console.error("[aimtell] "+e):console.log("[aimtell] "+e);1==_aimtellGetUrlVars().aimtelldebug&&(aimtellDebugBox.style.display="block",_aimtellDebugQueue.push({message:e,level:i||3}))}function _aimtellDebugQueueProcess(){0===_aimtellDebugQueueActive&&0<_aimtellDebugQueue.length?(_aimtellDebugQueueActive=1,_aimtellLogDebug(_aimtellDebugQueue[0].message,_aimtellDebugQueue[0].level).then(function(){var e=new Date,i=e.getHours().toString(),t=e.getMinutes().toString(),n=12<=i?"pm":"am";i=12<i?i-12:i,i="00"==i?12:i,1==i.length&&(i="0"+i),1==t.length&&(t="0"+t);var o="["+i+":"+t+n+"] ",s="";5==_aimtellDebugQueue[0].level&&(s=" <span style='color:red'>[error]</span> "),4==_aimtellDebugQueue[0].level&&(s=" <span style='color:orange'>[warning]</span> ");var r="<div class='aimtellDebugBoxItem'>"+o+s+_aimtellDebugQueue[0].message+"</div>",a=document.getElementById("aimtellDebugBoxList");a.innerHTML=r+a.innerHTML,_aimtellDebugQueueActive=0,_aimtellDebugQueue.shift(),_aimtellDebugQueueProcess()})):setTimeout(function(){_aimtellDebugQueueProcess()},1e3)}function _aimtellLogDebug(e,i){return new Promise(function(t){var n=new XMLHttpRequest;var o="https://log.aimtell.com/debug?type=trackpush";o+="&website_id="+_at.idSite,o+="&body="+e,o+="&log_level="+i,n.onreadystatechange=function(){if(4==n.readyState){var e=JSON.parse(n.responseText);t(e)}},n.open("POST",o,!0),n.setRequestHeader("Content-Type","application/json;charset=UTF-8"),n.send()})}function _aimtellInitialize(){return _aimtellDebugger("Initializing."),_at.idSite?"denied"==_aimtellCheckPermissions()?(_aimtellDebugger("User has denied push"),_aimtellTrackData.optin.action=2,_aimtellTrack(_aimtellTrackData,["optin"]),!1):"granted"==_aimtellCheckPermissions()?(_aimtellDebugger("User has already granted permissions, updating visitor"),_aimtellGetPushToken().then(function(e){if(e||_aimtellLogError("Push granted but no token found"),_aimtellSWInitiated||_aimtellNewSubscriberID)_aimtellDebugger("Updating optin details because of condition. New SW Initiated:"+_aimtellSWInitiated+" New Subscriber ID: "+_aimtellNewSubscriberID),_aimtellTrackData.optin.push_token=e,_aimtellTrackData.optin.action=1,_aimtellTrack(_aimtellTrackData,["optin"]),_aimtellAmplifySubscriberWorkerData();else{var i={};i.id_site=_aimtellTrackData.id_site,i.subscriber_uid=_aimtellTrackData.subscriber_uid,i.optin={},i.optin.action=1,i.optin.push_token=e,_aimtellTrack(i,["optin"])}_aimtellTrack(_aimtellTrackData,["attribute","page"]),_aimtellGetCookie("_aimtellSessionChecks")||(_aimtellAmplifySubscriberWorkerData(),_aimtellSetCookie("_aimtellSessionChecks",!0,1),_aimtellValidateSubscriber())}),!1):_aimtellGetCookie("_aimtellPromptDenied")?(_aimtellDebugger("User has denied prompt"),!1):_aimtellGetCookie("_aimtellPromptApproved")?(_aimtellDebugger("User has approved prompt, but never opted into native. Try clearing cookies.",4),!1):void _aimtellGetSiteConfig(_at.idSite).then(function(e){var t=_aimtellGetPageDetails().pageURL,n=0,o=0,s=null,r=null,a=null;t=t.replace(/(\/#|\/|#)$/,"");for(var d=_aimtellGetDeviceType(),l=0;l<e.length;l++)if(!(e[l].device_type&&e[l].device_type!=d&&"any"!=e[l].device_type)){var p=e[l].page;if(p=p.replace(/(\/#|\/|#)$/,""),p=p.replace(/\*|\/\*/g,"[^ ]*"),p=p.replace(/\?/g,"\\?"),p=p.replace(/https/g,"[^ ]*"),p=p.replace(/http/g,"[^ ]*"),p+="$",t.match(p)){n=e[l].promptId,o=e[l].auto_prompt,s=e[l].seconds_delay||null,r=e[l].scroll_delay||null,a=e[l].pages_delay||null;break}}0<n?_aimtellLoadPrompt(n,o,s,r,a):1==o?_aimtellPrompt():r?_aimtellEnableScrollDelayPrompt(r):s?_aimtellEnableSecondsDelayPrompt(s):a&&_aimtellEnablePageDelayPrompt(a)}):(_aimtellDebugger("[aimtell] - idSite must be set.",4),!1)}function _aimtellEnablePageDelayPrompt(e){var i=_aimtellGetCookie("_aimtellSessionPageViews");i++,i>=e&&_aimtellPrompt(),_aimtellSetCookie("_aimtellSessionPageViews",i)}function _aimtellEnableScrollDelayPrompt(e){window.addEventListener("scroll",function(){var i=_aimtellGetPercentageScrolled();i>=e&&!0!==_aimtellPrompted&&(_aimtellPrompt(),_aimtellPrompted=!0)})}function _aimtellEnableSecondsDelayPrompt(e){setTimeout(function(){!0!==_aimtellPrompted&&(_aimtellPrompt(),_aimtellPrompted=!0)},1e3*e)}function _aimtellValidateSubscriber(){var e=new XMLHttpRequest;e.onreadystatechange=function(){if(4==e.readyState&&200==e.status){var i=JSON.parse(e.responseText);i&&!0===i.update_sw&&(_aimtellDebugger("Revalidating Subscriber."),_aimtellForceRefreshSW(0))}},e.open("GET","https://analytics.aimtell.com/subscriber?id_site="+_at.idSite+"&subscriber_uid="+_at.subscriber,!0),e.send(null)}function _aimtellGetSiteConfig(e){return new Promise(function(i,t){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(4==n.readyState)if(404==n.status)_aimtellLogError("Unable to get site configuration file"),t("[aimtell] - Unable to retrieve configuration file. See more: https://aimtell.com/jserror/getsiteconfig");else{var e=JSON.parse(n.responseText);i(e)}},n.open("GET","https://s3.amazonaws.com/cdn.aimtell.com/config/"+e+"-"+_at.owner+".json",!0),n.send(null)})}function _aimtellGetPercentageScrolled(){var e=window.innerHeight||(document.documentElement||document.body).clientHeight,i=window.pageYOffset||(document.documentElement||document.body.parentNode||document.body).scrollTop,t=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight),n=Math.floor(100*(i/(t-e)));return n}function _aimtellLoadPrompt(e,i,t,n,o){var s=new XMLHttpRequest;s.onreadystatechange=function(){if(4==s.readyState){var e=JSON.parse(s.responseText),r=document.createElement("DIV");r.setAttribute("id","aimtellPrompt"),r.innerHTML=e.code,document.body.appendChild(r),document.getElementById("aimtellPrompt").style.display="none",_at.prompt.custom_prompt_id=e.id,_aimtellTrackData.optin.prompt_id=e.id,1==i?(_aimtellDebugger("Custom prompt loaded, trigger prompt()."),_aimtellPrompt()):t?_aimtellEnableSecondsDelayPrompt(t):n?_aimtellEnableScrollDelayPrompt(n):o&&_aimtellEnablePageDelayPrompt(o)}},s.open("GET","https://s3.amazonaws.com/cdn.aimtell.com/prompts/"+e+".json?cb="+Math.floor(Date.now()/1e3),!0),s.send(null)}function _aimtellPromptApprove(){_aimtellDebugger("Custom prompt approved."),document.getElementById("aimtellPrompt").style.display="none",_aimtellSetCookie("_aimtellPromptApproved",!0,7),_aimtellRunNative()}function _aimtellPromptDeny(){_aimtellDebugger("Custom prompt denied."),_aimtellSetCookie("_aimtellPromptDenied",!0,14),_aimtellTrackData.optin.action=2,_aimtellTrack(_aimtellTrackData,["optin"]),document.getElementById("aimtellPrompt").style.display="none"}function _aimtellPromptCancel(){_aimtellDebugger("Custom prompt cancelled."),document.getElementById("aimtellPrompt").style.display="none"}function _aimtellGetSubscriberID(){return new Promise(function(e){var i=_aimtellGetCookie("_aimtellSubscriberID");i?e(i):"granted"==_aimtellCheckPermissions()?_aimtellGetPushToken().then(function(t){return t?void _aimtellGetSubscriberIDFromToken(t).then(function(n){n.uid?i=n.uid:(i=_aimtellGenerateID(),_aimtellNewSubscriberID=!0,_at.attributes.push_token=t),_aimtellSetCookie("_aimtellSubscriberID",i,100),e(i)}):(_aimtellDebugger("A Fatal Error Occured. Permission granted but no token found.",5),!1)}):(i=_aimtellGenerateID(),_aimtellNewSubscriberID=!0,_aimtellSetCookie("_aimtellSubscriberID",i,100),e(i))})}function _aimtellIsNewData(e,i){if(!i)return!1;var t=!0,n=JSON.stringify(i),o=_aimtellHashString(n);if("undefined"!=typeof Storage){var s="_aimtellTrackData["+e+"]",r=sessionStorage.getItem(s);r==o?t=!1:sessionStorage.setItem(s,o)}return t}function _aimtellTrack(e,i){new XMLHttpRequest;var t={},n=0;t.id_site=e.id_site,t.subscriber_uid=e.subscriber_uid;var o=["attribute","optin","event","page","alias"];if(Array.isArray(i)&&(o=i),o.forEach(function(i){_aimtellIsNewData(i,e[i])&&(t[i]=e[i],n++)}),!n)return _aimtellDebugger("No New Track Data To Send"),!1;t=JSON.stringify(t);var s;s=new XMLHttpRequest,s.open("POST","https://analytics.aimtell.com/subscriber",!0),s.setRequestHeader("Content-Type","text/plain;charset=UTF-8"),s.send(t),_aimtellDebugger("Track Data Sent ")}function _aimtellAppendManifestHeader(e){if(!document.querySelector("link[rel=\"manifest\"]")){var i=document.createElement("link");i.rel="manifest",i.href=e,document.head.appendChild(i)}}function _aimtellGetManifestLocation(){return new Promise(function(e){if("undefined"!=typeof _at.manifest)_aimtellAppendManifestHeader(_at.manifest),e(_at.manifest);else{var i=new XMLHttpRequest,t="https://s3.amazonaws.com/cdn.aimtell.com/manifest/"+_at.idSite+".json";i.onreadystatechange=function(){if(4==i.readyState)if(404==i.status)_at.manifest=window.location.origin+"/aimtell-manifest.json",_aimtellAppendManifestHeader(_at.manifest),e(_at.manifest);else{var n=JSON.parse(i.responseText);_at.gcm_id=n.gcm_sender_id,_at.manifest=t,_aimtellAppendManifestHeader(_at.manifest),e(_at.manifest)}},i.open("GET",t,!0),i.send(null)}})}function _aimtellGetGCMID(){return new Promise(function(e,i){_at.gcm_id&&e(_at.gcm_id),_aimtellGetManifestLocation().then(function(t){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(4==n.readyState)if(404==n.status)_aimtellLogError("Missing manifest file"),i("[aimtell] - Missing Manifest file");else{var t=JSON.parse(n.responseText);e(t.gcm_sender_id)}},n.open("GET",t,!0),n.send(null)})})}function _aimtellLogError(e,i){if("undefined"==typeof i&&(i=0),_aimtellIsNewData("error",e)){var t=new XMLHttpRequest;var n="https://log.aimtell.com/error?type=trackpush";n+="&website_id="+_at.idSite,n+="&body="+e,n+="&log_level="+i,t.open("POST",n,!0),t.setRequestHeader("Content-Type","application/json;charset=UTF-8"),t.send()}}function _aimtellGetSubscriberIDFromToken(e){return new Promise(function(i){_aimtellDebugger("Update SubscriberID From Token Ran ");var t=new XMLHttpRequest;t.onreadystatechange=function(){if(4==t.readyState){var e=JSON.parse(t.responseText);i(e)}},t.open("GET",_aimtellAPI+"/subscriber/token/"+e+"?id_site="+_at.idSite,!0),t.send(null)})}function _aimtellGetSubscriberAttributes(){return new Promise(function(e){var i=new XMLHttpRequest;i.onreadystatechange=function(){if(4==i.readyState){var t=JSON.parse(i.responseText);e(t)}};var t=_aimtellAPI+"/subscriber/"+_at.subscriber+"/attributes";t+="?idSite="+_at.idSite,i.open("GET",t,!0),i.send(null)})}function _aimtellGenerateID(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}function _aimtellGetCookie(e){for(var t,n=e+"=",o=document.cookie.split(";"),s=0;s<o.length;s++){for(t=o[s];" "==t.charAt(0);)t=t.substring(1);if(0==t.indexOf(n))return t.substring(n.length,t.length)}return""}function _aimtellSetCookie(e,i,t){var n=new Date;n.setTime(n.getTime()+1e3*(60*(60*(24*t))));var o="expires="+n.toUTCString();document.cookie=e+"="+i+"; path=/ ;"+o}function _aimtellDeleteCookie(e){document.cookie=e+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}function _aimtellHashString(e,t,n){var o,s,r=n===void 0?2166136261:n;for(o=0,s=e.length;o<s;o++)r^=e.charCodeAt(o),r+=(r<<1)+(r<<4)+(r<<7)+(r<<8)+(r<<24);return t?("0000000"+(r>>>0).toString(16)).substr(-8):r>>>0}function _aimtellTrackAttributes(e){Object.keys(e).forEach(function(i){_aimtellTrackData.attribute[i]=e[i]}),_aimtellTrack(_aimtellTrackData,["attribute"])}function _aimtellForcePrompt(){if("granted"==_aimtellCheckPermissions()||"denied"==_aimtellCheckPermissions())return!1;var e=document.getElementById("aimtellPrompt");"undefined"!=typeof e&&null!=e&&(_aimtellDebugger("Showing Custom Prompt "),document.getElementById("aimtellPrompt").style.display="block")}function _aimtellPrompt(){if("granted"==_aimtellCheckPermissions()||"denied"==_aimtellCheckPermissions)return!1;if(_aimtellGetCookie("_aimtellPromptDenied"))return _aimtellDebugger("User has denied prompt"),!1;var e=document.getElementById("aimtellPrompt");"undefined"!=typeof e&&null!=e?(_aimtellDebugger("Showing Custom Prompt "),document.getElementById("aimtellPrompt").style.display="block"):(_aimtellDebugger("Loading Native Prompt "),_aimtellRunNative())}function _aimtellAlias(e){var i={};i.id_site=_aimtellTrackData.id_site,i.subscriber_uid=_aimtellTrackData.subscriber_uid,i.alias=e,_aimtellTrack(i,["alias"])}function _aimtellTrackEvent(e,i,t,n){return!1!=_aimtellSupportsPush()&&void(_aimtellDebugger("Track Event Sent "),_aimtellTrackData.event.category=e,_aimtellTrackData.event.action=i,t&&(_aimtellTrackData.event.label=t),n&&(_aimtellTrackData.event.value=n),_aimtellTrack(_aimtellTrackData,["event"]))}function _aimtellAbandonedCart(e,i){if(!1==_aimtellSupportsPush())return!1;if(null==e)return!1;var t={};t.type=e,i&&(t.delay=i),t.idSite=_at.idSite,t.owner_uid=_at.owner,t=JSON.stringify(t);var n;n=new XMLHttpRequest,n.open("POST",_aimtellAPI+"/subscriber/"+_at.subscriber+"/cart",!0),n.setRequestHeader("Content-Type","text/plain;charset=UTF-8"),n.setRequestHeader("Aimtell-Track-Source","js"),n.send(t),_aimtellDebugger("Abandoned Cart Data Sent ")}function _aimtellTc(e,i,t){return new Promise(function(n,o){var s=new XMLHttpRequest;s.onreadystatechange=function(){if(4==s.readyState)if(404==s.status)o("[aimtell] - Unable to track.");else{var e=JSON.parse(s.responseText);n(e)}};var r={};r.subscriber_uid=i,r.logid=e,r.redirect_url=t,r=JSON.stringify(r),s.open("POST",_aimtellAPI+"/push/click/"+e,!0),s.setRequestHeader("Content-Type","text/plain;charset=UTF-8"),s.setRequestHeader("Aimtell-Track-Source","js"),s.send(r)})}var webURL=_aimtellGetUrlVars().atlink;if(webURL){var logid=_aimtellGetUrlVars().logid,subscriber_uid=_aimtellGetUrlVars().subscriber_uid;_aimtellTc(logid,subscriber_uid,webURL).then(function(e){e&&"error"==e.result?console.warn("[aimtell] Invalid Redirect URL"):e&&"success"==e.result&&e.redirect_url&&(window.location=e.redirect_url)})}function _aimtellGetPushToken(){return new Promise(function(e){!1==_aimtellSupportsPush()&&(_aimtellPushToken=null,e(_aimtellPushToken)),"safari"in window&&"pushNotification"in window.safari?(_aimtellPushToken=window.safari.pushNotification.permission(_at.webpushid).deviceToken,e(_aimtellPushToken)):"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(i){i.pushManager.getSubscription().then(function(i){i?(_aimtellPushToken=_aimtellExtractSubscriptionId(i.endpoint),e(_aimtellPushToken)):"granted"==_aimtellCheckPermissions()?navigator.serviceWorker.ready.then(function(i){i.pushManager.subscribe({userVisibleOnly:!0}).then(function(i){_aimtellPushToken=_aimtellExtractSubscriptionId(i.endpoint),_aimtellSWInitiated=!0,e(_aimtellPushToken)})}):(_aimtellPushToken=null,e(_aimtellPushToken))})})})}function _aimtellSupportsPush(){var e=!1;return"safari"in window&&"pushNotification"in window.safari&&(e=!0),"Safari"==_aimtellGetBrowserInfo().browser&&window.top!==window&&(e=!0),"serviceWorker"in navigator&&"Safari"!=_aimtellGetBrowserInfo().browser&&(e=!0,!("showNotification"in ServiceWorkerRegistration.prototype)&&(e=!1),!("PushManager"in window)&&(e=!1),!1==_aimtellCheckHTTPS()&&(e=!1)),"Promise"in window||(e=!1),"Edge"==_aimtellGetBrowserInfo().browser&&(e=!1),e}function _aimtellCheckHTTPS(){var e=!1,i=window.location.protocol;return"https:"==i&&(e=!0),e}function _aimtellListener(e,i,t){e.addEventListener(i,t)}function _webpushCheckPermissions(){return _aimtellCheckPermissions()}function _webpushSupportsPush(){return _aimtellSupportsPush()}function _webpushPrompt(){_aimtellPrompt()}function _webpushRunNative(){_aimtellRunNative()}function _webpushGetSubscriberIDFromToken(e){return new Promise(function(i){aimtellGetSubscriberIDFromToken(e).then(function(e){i(e)})})}function _webpushTrackAttributes(e){_aimtellTrackAttributes(e)}function _webpushGetToken(){return new Promise(function(e){_aimtellGetPushToken().then(function(i){e(i)})})}function _webpushTrackEvent(e,i,t,n){_aimtellTrackEvent(e,i,t,n)}function _webpushGetSubscriberID(){return new Promise(function(e){_aimtellGetSubscriberID().then(function(i){e(i)})})}function _aimtellCheckPermissions(){if("safari"in window&&"pushNotification"in window.safari)return window.safari.pushNotification.permission(_at.webpushid).permission;return"Notification"in window&&"permission"in window.Notification?Notification.permission:void 0}function _aimtellRunNative(){if(!1==_aimtellSupportsPush())return _aimtellDebugger("Browser doesn't support push"),!1;if("safari"in window&&"pushNotification"in window.safari){var e=window.safari.pushNotification.permission(_at.webpushid);return _aimtellDebugger(e),_aimtellSafariRun(e),!1}"serviceWorker"in navigator&&_aimtellChromeRun()}function _aimtellSafariRun(e){if("default"===e.permission){_aimtellDebugger("User Requested Permissions");var i=_at.domain,t=i.indexOf("/");i=i.substring(0,-1==t?i.length:t),window.safari.pushNotification.requestPermission("https://api-lambda.aimtell.com/prod/safari-package/"+i,_at.webpushid,{},_aimtellSafariRun)}else if("denied"===e.permission)_aimtellDebugger("User Denied Permissions"),_aimtellTrackData.optin.action=2,_aimtellTrack(_aimtellTrackData,["optin"]),"undefined"!=typeof _aimtellPermissionDenied&&_aimtellPermissionDenied();else if("granted"===e.permission){var n=e.deviceToken;_aimtellTrackData.optin.action=1,_aimtellTrackData.optin.push_token=n,_aimtellTrack(_aimtellTrackData,["attribute","optin","page"]),_aimtellTrackAttributes({subscription_url:window.location.href}),_aimtellPermissionGrantedCallbacks()}}function _aimtellDelWidgetNotification(e){document.getElementById("webwidget-notification-"+e).remove();document.getElementById("notification-badge");_aimtellCheckNotificationRemaining()}function _aimtellDelAllWidgetNotification(){document.getElementById("webwidget-body").innerHTML="",_aimtellShowNoNotifications()}function _aimtellCheckNotificationRemaining(){var e=document.getElementsByClassName("webwidget-notification");document.getElementById("notification-badge-count").innerHTML=e.length,document.getElementById("notification-badge").style.opacity=1,0==e.length&&(_aimtellShowNoNotifications(),document.getElementById("notification-badge").style.opacity=0)}function _aimtellClickedNotification(e,i){_aimtellDelWidgetNotification(e),window.open(i)}function _aimtellShowNotificationCenter(){var e=document.getElementById("notification-icon");e.className="transition-hide";var e=document.getElementById("notification-icon-close");e.className="transition-show";var e=document.getElementById("webwidget-content");e.className="show-widget-contents"}function _aimtellHideNotificationCenter(){var e=document.getElementById("notification-icon");e.className="transition-show";var e=document.getElementById("notification-icon-close");e.className="transition-hide";var e=document.getElementById("webwidget-content");e.className="hide-widget-contents"}function _aimtellAppendNotification(e,i,t,n,o){var s=document.getElementById("webwidget-body"),r="<div id=\"webwidget-notification-"+e+"\" class=\"webwidget-notification\">";r+="<div onClick=\"_aimtellDelWidgetNotification("+e+")\" class=\"webwidget-notification-del\">X</div>",r+="<div onClick=\"_aimtellClickedNotification("+e+",'"+o+"', this)\" class=\"webwidget-notification-img\">",r+="<img src=\""+n+"\">",r+="</div>",r+="<div onClick=\"_aimtellClickedNotification("+e+",'"+o+"', this)\" class=\"webwidget-notification-text\">",r+="<span class=\"webwidget-notification-title\">"+i+"</span>",r+="<span class=\"webwidget-notification-body\">"+t+"</span>",r+="</div>",r+="</div>",s.innerHTML+=r}function _aimtellShowNoNotifications(){var e="<div id=\"webwidget-pushbell\" >";e+="<img src=\"push_bell_large.png\">",e+="<span id=\"webwidget-text\">No new notifications, check back later!</span>",e+="</div>",document.getElementById("webwidget-body").innerHTML=e,document.getElementById("notification-badge").style.opacity=0}function _aimtellShowNotSubscribed(){var e="<div id=\"webwidget-pushbell\" >";e+="<img src=\"push_bell_large.png\">",e+="<span id=\"webwidget-text\">You are not currently subscribed.</span>",e+="<div onClick=\"_aimtellPrompt()\" id=\"webwidget-subscribe\"><span>Click to subscribe</span></div>",e+="</div>",document.getElementById("webwidget-body").innerHTML=e}function _aimtellLaunchNotificationCenter(){var e=document.createElement("style");e.innerHTML="#webwidget{width:70px;height:70px;position:fixed;bottom:25px;left:25px;border-radius:50%;background-color:#3cba5d;display:block;box-shadow:0 1px 6px rgba(0,0,0,.15),0 2px 32px rgba(0,0,0,.15)!important}#webwidget:hover{box-shadow:0 1px 6px rgba(0,0,0,.20),0 2px 32px rgba(0,0,0,.20)!important;cursor:pointer}#webwidget #notification-badge{display:block;position:absolute;right:0;top:0;background-color:#e95269;color:#FFF;border-radius:50%;width:25px;height:25px;opacity:0}#webwidget #notification-badge span{display:block;margin:0 auto;text-align:center;margin-top:2px}#webwidget #notification-icon,#webwidget #notification-icon-close{position:absolute;left:17px;top:17px}#webwidget #notification-icon{opacity:1;z-index:9}#webwidget #notification-icon-close{opacity:0}#webwidget .transition-show{opacity:1!important;z-index:9;-webkit-transition:opacity .2s ease-in-out;-moz-transition:opacity .2s ease-in-out;-o-transition:opacity .2s ease-in-out;transition:opacity .2s ease-in-out;-webkit-transition:.3s ease-in-out;-moz-transition:.3s ease-in-out;-o-transition:.3s ease-in-out;transition:.3s ease-in-out;-webkit-transform:rotate(45deg);-moz-transform:rotate(45deg);-o-transform:rotate(45deg);transform:rotate(0deg)}#webwidget .transition-hide{opacity:0!important;z-index:8;-webkit-transition:opacity .2s ease-in-out;-moz-transition:opacity .2s ease-in-out;-o-transition:opacity .2s ease-in-out;transition:opacity .2s ease-in-out;-webkit-transition:.3s ease-in-out;-moz-transition:.3s ease-in-out;-o-transition:.3s ease-in-out;transition:.3s ease-in-out;-webkit-transform:rotate(45deg);-moz-transform:rotate(45deg);-o-transform:rotate(45deg);transform:rotate(45deg)}#webwidget #notification-icon-close{left:28px;top:20px;font-size:22px;color:#FFF}#webwidget-content{opacity:0;-webkit-transition:opacity .2s ease-in-out;-moz-transition:opacity .2s ease-in-out;-o-transition:opacity .2s ease-in-out;transition:opacity .2s ease-in-out;height:500px;width:350px;display:block;background-color:#FFF;position:absolute;top:-515px;left:25px;border-radius:10px}#webwidget-content.show-widget-contents{opacity:1!important}#webwidget-content.hide-widget-contents{opacity:0!important}#webwidget-content-header{background-color:#3cba5d;color:#FFF;padding:20px}#webwidget-content-header span{display:block;font-size:16px}#webwidget #webwidget-content #webwidget-pushbell img{display:block;margin:0 auto;margin-top:25px}#webwidget #webwidget-content #webwidget-pushbell{padding:20px}#webwidget #webwidget-content #webwidget-pushbell span{display:block;text-align:center;padding-top:15px}#webwidget #webwidget-content #webwidget-pushbell #webwidget-subscribe span{display:block;text-align:center;padding:10px;background:#428bca;border-radius:2px;margin:0 auto;color:#FFF;width:175px;cursor:pointer;margin-top:15px}#webwidget-footer{position:absolute;bottom:10px;margin:0 auto;display:block;border-top:1px solid #E9E9E9;padding-top:10px;width:100%}#webwidget-footer span,#webwidget-footer a{display:block;text-align:center;font-size:12px;color:#615d5d}.webwidget-notification{border-top:1px solid #f7f5f5;position:relative}.webwidget-notification-del{position:absolute;top:5px;right:5px;cursor:pointer;z-index:10;color:#f7f5f5}.webwidget-notification-del:hover{color:#e95269}.webwidget-notification:hover{background:#f7f5f5;cursor:pointer}.webwidget-notification img{display:block;margin:0 auto;max-width:100%}.webwidget-notification .webwidget-notification-img{display:inline-block;float:left;width:25%;padding:15px}.webwidget-notification .webwidget-notification-text{display:inline-block;width:75%;padding:15px 15px 15px 0}.webwidget-notification .webwidget-notification-text span{display:block}.webwidget-notification .webwidget-notification-text span.webwidget-notification-title{font-weight:500}#webwidget-clearall{display:block;margin:0 auto;text-align:center;color:#E9E9E9}",document.body.appendChild(e);var i=document.createElement("div");i.setAttribute("id","aimtellNotificationCenter"),i.innerHTML="<div id=\"webwidget\"><img onClick=\"_aimtellShowNotificationCenter()\" id=\"notification-icon\" src=\"notification_icon.png\"><div onClick=\"_aimtellHideNotificationCenter()\" id=\"notification-icon-close\"> X </div><div id=\"notification-badge\"><span id=\"notification-badge-count\">3</span></div><div id=\"webwidget-content\"><div id=\"webwidget-content-header\"> <span>Notifications</span> </div><div id=\"webwidget-body\"></div><div id=\"webwidget-footer\"><a target=\"_BLANK\" href=\"https://aimtell.com\"><span>Powered By Aimtell</span></a></div></div></div>",document.body.appendChild(i);var t=_aimtellCheckPermissions();return"granted"==t?void _aimtellGetWidgetNotifications().then(function(e){_aimtellFillNotifications(e)}):void _aimtellShowNotSubscribed()}function _aimtellGetWidgetNotifications(){return new Promise(function(e){var i=new XMLHttpRequest;if(i.onreadystatechange=function(){if(4==i.readyState)if(404==i.status);else{JSON.parse(i.responseText);e(i.responseText)}},"undefined"!=typeof _at&&"undefined"!=typeof _at.subscriber){var t=_at.idSite,n=_at.subscriber;i.open("GET","https://api.aimtell.com/prod/widget/notifications/"+t+"/"+n,!0),i.send(null)}})}function _aimtellFillNotifications(e){e=JSON.parse(e);var t=e.length;if(1>t)return _aimtellShowNoNotifications(),!1;var n=e.length;document.getElementById("webwidget-body").innerHTML="";for(var o=0;o<n;o++)_aimtellAppendNotification(123,e[o].title,e[o].body,e[o].icon,e[o].link);document.getElementById("webwidget-body").innerHTML+="<span onClick='_aimtellDelAllWidgetNotification()' id='webwidget-clearall'> - clear all - </span>",_aimtellCheckNotificationRemaining()}function _aimtellWidgetPermissionGrantedCallback(){_aimtellShowNoNotifications()}function _aimtellPermissionGrantedCallbacks(){"undefined"!=typeof _aimtellPermissionGranted&&_aimtellPermissionGranted(),"undefined"!=typeof _aimtellWidgetPermissionGrantedCallback&&null!=document.getElementById("webwidget")&&_aimtellWidgetPermissionGrantedCallback(),_aimtellAmplifySubscriberWorkerData()}function _aimtellChromeRun(){navigator.serviceWorker.ready.then(function(e){e.pushManager.getSubscription().then(function(e){return e?void(_aimtellDebugger("Subscription Found ",subcription),_aimtellSendSubscriptionToServer(e)):(_aimtellDebugger("No Subscription Found. Prompting "),void _aimtellSubscribe())}).catch(function(e){_aimtellLogError(e.message),_aimtellDebugger("Error during getSubscription()",4)})})}function _aimtellSubscribe(){_aimtellDebugger("Checking if worker is ready."),navigator.serviceWorker.ready.then(function(e){_aimtellDebugger("Worker is ready."),e.pushManager.subscribe({userVisibleOnly:!0}).then(function(e){return _aimtellDebugger("Chrome subscription successful"),_aimtellTrackAttributes({subscription_url:window.location.href}),localStorage.setItem("aimtell_gcm_id",_at.gcm_id),localStorage.setItem("aimtell_subscriber_uid",_at.subscriber),_aimtellPermissionGrantedCallbacks(),_aimtellSendSubscriptionToServer(e)}).catch(function(i){"denied"===Notification.permission?(_aimtellDebugger("Chrome permission denied"),_aimtellTrackData.optin.action=2,_aimtellTrack(_aimtellTrackData,["optin"]),"undefined"!=typeof _aimtellPermissionDenied&&_aimtellPermissionDenied()):(_aimtellDebugger("Unable to subscribe to push: "+i.message,4),_aimtellLogError(i.message),"undefined"!=typeof _aimtellPermissionDenied&&_aimtellPermissionDenied())})})}function _aimtellExtractSubscriptionId(e){var i=e.toString().split("/"),t=i[i.length-1];return t}function _aimtellSendSubscriptionToServer(e){var i=e.endpoint,t=_aimtellExtractSubscriptionId(i);"granted"==_aimtellCheckPermissions()&&(_aimtellRegisterWorker(),_aimtellTrackData.optin.action=1,_aimtellTrackData.optin.push_token=t,_aimtellTrackData.optin.endpoint=i,_aimtellTrack(_aimtellTrackData,["attribute","optin","page"]))}function _aimtellAmplifySubscriberWorkerData(){_aimtellSendWorkerMessage({command:"store",subscriber_uid:_at.subscriber,id_site:_at.idSite}).then(function(){_aimtellDebugger("Postmessage successfully.")})}function _aimtellRegisterWorker(){_aimtellSendWorkerMessage({command:"register",uid:_at.subscriber_uid}).then(function(){_aimtellDebugger("Service worker registered successfully.")})}function _aimtellSendWorkerMessage(e){return new Promise(function(i,t){var n=new MessageChannel;n.port1.onmessage=function(e){e.data.error?t(e.data.error):i(e.data)},navigator.serviceWorker.controller.postMessage(e,[n.port2])})}function _aimtellLoad(){return new Promise(function(e,i){"serviceWorker"in navigator&&navigator.serviceWorker.register(_at.worker,{scope:"/",updateViaCache:"none"}).catch(function(e){0<e.message.indexOf("behind a redirect")&&null!==_aimtellUserDefinedWorker?navigator.serviceWorker.register(_aimtellUserDefinedWorker,{scope:"/",updateViaCache:"none"}).catch(function(e){i(e)}):i(e)}),_aimtellGetGCMID().then(function(i){if(!i)throw new Error("[aimtell] - Unable to grab GCM id");_at.gcm_id=i,_aimtellGetSubscriberID().then(function(t){_at.subscriber=t,_aimtellSubscriberID=t;var n=_aimtellGetBrowserInfo(),o=_aimtellGetPageDetails(),s=_aimtellGetReferrer(),r=_aimtellGetSystemInfo(),a=_aimtellGetLanguage(),d=_aimtellGetResolution(),l=_aimtellGetDeviceType();_at.prompt={},trackData={},trackData.idSite=_at.idSite,trackData.visitor_subscriber_uid=_at.subscriber,trackData.visitor_localtime=new Date,trackData.device_type=l,trackData.device_resolution=d,trackData.browser_name=n.browser,trackData.browser_version=n.version,trackData.device_os=r.os,trackData.device_os_version=r.osVersion,trackData.referrer_url=s.refUrl,trackData.referrer_name=s.refName,trackData.browser_lang=a,trackData.page_title=o.pageTitle,trackData.page_url=o.pageURL,_aimtellTrackData={},_aimtellTrackData.subscriber_uid=_at.subscriber,_aimtellTrackData.id_site=_at.idSite,_aimtellTrackData.attribute=_aimtellPageLoadAttributes,_aimtellTrackData.attribute.device_type=_aimtellGetDeviceType(),_aimtellTrackData.attribute.browser_name=n.browser,_aimtellTrackData.attribute.device_os=r.os,_aimtellTrackData.attribute.browser_lang=_aimtellGetLanguage(),_aimtellTrackData.page={},_aimtellTrackData.page.url=o.pageURL,_aimtellTrackData.optin={},_aimtellTrackData.optin.action=null,_aimtellTrackData.optin.prompt_id=null,_aimtellTrackData.optin.gcm_id=i,_aimtellTrackData.optin.push_token=null,_aimtellTrackData.event={},_aimtellTrackData.event.category=null,_aimtellTrackData.event.action=null,_aimtellTrackData.event.label=null,_aimtellTrackData.event.value=null,e()})})})}function _aimtellProcessQueue(e){if(e&&0!=e.length){for(var t=0,n=e.length;t<n;t++){var o=e[t][0],s=e[t][1];"alias"==o?_aimtellAlias(s):"event"==o?_aimtellTrackEvent(s.category,s.action,s.label,s.value):"attribute"==o&&_aimtellTrackAttributes(s)}return!0}}function _aimtellForceRefreshSW(e){if("number"!=typeof e)return _aimtellDebugger("[aimtell] - Force refresh value is not a number"),!1;if(0==e&&1!=sessionStorage.getItem("_aimtellSWForcedSession"));else if(1==_aimtellGetCookie("_aimtellSWForced"))return _aimtellDebugger("Subscriber has recently force refreshed push worker"),!1;return _aimtellDebugger("Force updating push worker"),navigator.serviceWorker.getRegistrations().then(function(e){e[0]&&e[0].unregister()}),sessionStorage.setItem("_aimtellSWForcedSession",1),1>e&&(e=1),_aimtellSetCookie("_aimtellSWForced",1,e),!0}(function(){if("undefined"==typeof _aimtellRanScript)_aimtellRanScript=!0;else return _aimtellLogError("Script loaded twice",1),_aimtellDebugger("[aimtell] Script loaded twice.",4),!1;if(!1==_aimtellSupportsPush())return _aimtellDebugger("Browser does not support push",5),"undefined"!=typeof _aimtellPushSupported&&_aimtellPushSupported(!1),!1;if("undefined"!=typeof _aimtellPushSupported&&_aimtellPushSupported(!0),document.querySelector("link[rel=\"manifest\"]")){_aimtellDebugger("There may already be a manifest file which superscedes ours. See https://aimtell.com/jserror/manifestexists",4)}"undefined"==typeof _at.forceRefreshSW?"serviceWorker"in navigator&&7487==_at.idSite&&(_aimtellRefreshResult=_aimtellForceRefreshSW(30)):_aimtellRefreshResult=_aimtellForceRefreshSW(_at.forceRefreshSW),_aimtellLoad().then(function(){_aimtellInitialize(_at.idSite),_aimtellLoadBeacon(),setTimeout(function(){"undefined"!=typeof _aimtellReady&&_aimtellReady(),"undefined"!=typeof _aimtellShopifyReady&&_aimtellShopifyReady()},1500),"undefined"!=typeof _at.track&&(_aimtellProcessQueue(_at.track.q),window._at.track=function(){var e=[];return e.push(arguments),_aimtellProcessQueue(e),!0})}).catch(function(e){_aimtellLogError(e,1),_aimtellDebugger(e,5)})})();